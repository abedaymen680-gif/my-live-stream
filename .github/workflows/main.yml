name: 5 Minute Video Grabber

on:
  workflow_dispatch:

jobs:
  download:
    runs-on: ubuntu-latest
    steps:
      - name: Install FFmpeg
        run: sudo apt-get update && sudo apt-get install -y ffmpeg

      - name: Download 5 Minutes
        run: |
          # سيقوم بتحميل 5 دقائق (300 ثانية) وحفظها باسم test_clip.mp4
          # أضفنا User Agent لضمان عدم حظر السيرفر للتحميل
          ffmpeg -i "http://5-host.xyz:8080/live/177716153252/17laOe555B/431637.m3u8" \
          -t 300 -c copy -user_agent "Mozilla/5.0" test_clip.mp4

      - name: Upload Video as Artifact
        uses: actions/upload-artifact@v4
        with:
          name: my-5-minute-video
          path: test_clip.mp4
          
